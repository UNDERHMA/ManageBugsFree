<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
              
    <h:body>

        <ui:include src="templates/template.xhtml" />
        
        <h1>
            <i class="fa fa-bolt"></i> 
            My LBT Reports 
        </h1>
        
         <h:form id="searchform" class="navbar-form navbar-center">
            <p:panel id="panel" header="Search Form">
            
                        <h:outputLabel for="lbtreportid" value="LBTReportID: "/>
                         &nbsp;
                        <h:inputText id ="lbtreportid"
                                     value="#{lBTReportListController.searchFunction.lbtReportId}"
                                     class="form-control focus formitem-bugsapp"
                                     maxlength="10"
                                     />
                         &nbsp;
                        <h:outputLabel for="title" value="Title: "/>
                         &nbsp;
                        <h:inputText id ="title"
                                     value="#{lBTReportListController.searchFunction.title}"
                                     class="form-control focus formitem-bugsapp"
                                     maxlength="100"
                                     />
                        &nbsp;
                        <h:outputLabel for="topic" value="Topic: "/>
                         &nbsp;
                        <h:selectOneMenu id ="topic"
                                     value="#{lBTReportListController.searchFunction.topic}"
                                     class="form-control focus formitem-bugsapp">
                            <f:selectItems  value="#{lBTReportListController.topics}"/>
                        </h:selectOneMenu>
                         &nbsp;
                        <h:outputLabel for="linkedbugreportids" value="Linked Bug Report ID: "/>
                         &nbsp;
                        <h:inputText id ="linkedbugreportids"
                                     value="#{lBTReportListController.searchFunction.bugReportId}"
                                     class="form-control focus formitem-bugsapp"
                                     maxlength="10"
                                     />
                        &nbsp;
                        <h:outputLabel for="similarbrid" value="Similar BR ID:"/>
                        &nbsp;
                        <h:inputText id ="similarbrid"
                                     value="#{lBTReportListController.searchFunction.similarBugReportId}"
                                     class="form-control focus formitem-bugsapp"
                                     maxlength="10"/>
                         <br></br> 
                         <h:outputLabel for="developmentteam" value="Development Team:"/>
                         &nbsp;
                        <h:selectOneMenu id ="developmentteam"
                                     value="#{lBTReportListController.searchFunction.developmentTeam}"
                                     class="form-control focus formitem-bugsapp">
                                     <f:selectItems  value="#{lBTReportListController.developmentTeams}"/>
                        </h:selectOneMenu>
                          &nbsp;
                        <h:outputLabel for="severityestimate" value="Support Severity Estimate:"/>
                         &nbsp;
                        <h:selectOneMenu id ="severityestimate"
                                     value="#{lBTReportListController.searchFunction.severityEstimate}"
                                     class="form-control focus formitem-bugsapp">
                                     <f:selectItems  value="#{lBTReportListController.priorities}"/>
                        </h:selectOneMenu>
                        &nbsp;
                        <h:outputLabel for="softwareversion" value="Software Version:"/>
                        &nbsp;
                         <h:selectOneMenu id ="softwareversion"
                                     value="#{lBTReportListController.searchFunction.softwareVersion}"
                                     class="form-control focus formitem-bugsapp">
                            <f:selectItems  value="#{lBTReportListController.softwareVersions}"/>
                        </h:selectOneMenu>
                        &nbsp;
                        <h:outputLabel for="usersubmitted" value="Submitted By:"/>
                         &nbsp;
                        <h:selectOneMenu id ="usersubmitted"
                                     value="#{lBTReportListController.searchFunction.userSubmitted}"
                                     class="form-control focus formitem-bugsapp">
                            <f:selectItems  value="#{lBTReportListController.users2}"/>
                        </h:selectOneMenu>
                         <br></br>
                         <h:outputLabel value="Open Date Between: "/>
                         &nbsp;
                        <p:calendar id ="startdate"
                                    value="#{lBTReportListController.searchFunction.startDate}"
                                    class ="ui-inputfield"
                                     />
                         &nbsp;
                        <h:outputLabel value="&amp;"/>
                         &nbsp;
                        <p:calendar id ="enddate"
                                     value="#{lBTReportListController.searchFunction.endDate}"
                                     class ="ui-inputfield"/>
                        &nbsp;
                        <h:outputLabel value="All Linked BRs Closed Between: "/>
                         &nbsp;
                        <p:calendar id ="startdatefirstclosed"
                                    value="#{lBTReportListController.searchFunction.startDateAllBRsClosed}"
                                    class ="ui-inputfield"
                                     />
                        &nbsp; 
                        <h:outputLabel value="&amp;"/>
                        &nbsp;
                        <p:calendar id ="enddatefirstclosed"
                                     value="#{lBTReportListController.searchFunction.endDateAllBRsClosed}"
                                     class ="ui-inputfield"
                                    />
                        &nbsp; 
                        <h:outputLabel value="Active LBTs Only"/>
                        &nbsp;
                        <p:selectBooleanCheckbox  id ="activelbts"
                                     value="#{lBTReportListController.searchFunction.activeReports}"
                                    />
                        <br></br> 
                         <h:outputLabel for="userassigned" value="User Assigned:"/>
                         &nbsp;
                        <h:selectOneMenu id ="userassigned"
                                     value="#{lBTReportListController.searchFunction.userAssigned}"
                                     class="form-control focus formitem-bugsapp">
                            <f:selectItems  value="#{lBTReportListController.users}"/>
                        </h:selectOneMenu>
                        &nbsp;
                        <h:outputLabel for="customersupportteam" value="Customer Support Team:"/>
                         &nbsp;
                        <h:selectOneMenu id ="customersupportteam"
                                     value="#{lBTReportListController.searchFunction.customerSupportTeam}"
                                     class="form-control focus formitem-bugsapp">
                                     <f:selectItems  value="#{lBTReportListController.customerSupportTeams}"/>
                        </h:selectOneMenu>
                         &nbsp;
                        <h:outputLabel for="abbreviatedstacktrace" value="Stack Trace Text:"/>
                        &nbsp;
                        <h:inputText id ="abbreviatedstacktrace"
                                     value="#{lBTReportListController.searchFunction.abbreviatedStackTrace}"
                                     class="form-control focus formitem-bugsapp"
                                     maxlength="150"
                                     />
                        &nbsp;
                        <h:outputLabel for="bugdescription" value="BR Description Text:"/>
                        &nbsp;
                        <h:inputText id ="bugdescription"
                                     value="#{lBTReportListController.searchFunction.bugDescription}"
                                     class="form-control focus formitem-bugsapp"
                                     maxlength="150"
                                     />
                        <br></br>
                        <p:commandButton value="Search"
                                 action="#{lBTReportListController.search}"
                                 update=":table"
                        />
            </p:panel>
        </h:form>
        <br></br>
        <!--Drawn from Primefaces example https://www.primefaces.org/showcase/ui/data/datatable/lazy.xhtml-->
        <!--MIT License contained in this package folder src/main/webapp folder-->
        <p:dataTable id="table" var="dataItem" value="#{lBTReportListController.lbtReportModel}" 
                     paginator = "true" rows="25" paginatorTemplate = "{FirstPageLink} 
                     {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}" lazy="true">
            <p:column headerText="LBT Report ID" sortBy="#{dataItem.lbtReportId}">
                <h:outputLink class="tablelinks" value = "LBTReport.xhtml" >
                    #{dataItem.lbtReportId}
                    <f:param name="lbtReportId" value="#{dataItem.lbtReportId}" />
                </h:outputLink>
            </p:column>
            <p:column headerText="Title" sortBy="#{dataItem.title}" style="width:150px;">
                <h:outputText value="#{dataItem.title}" />
            </p:column>
            <p:column headerText="Topic" sortBy="#{dataItem.topic}">
                <h:outputText value="#{dataItem.topic}" />
            </p:column>
            <p:column headerText="Linked to BR ID"  style="width:60px;">
                <ul class="tablelinks">
                    <ui:repeat value="#{dataItem.linkedBugReportIds}" var="linkedbugreportslist">
                        <li>
                            <h:outputLink class="tablelinks" value = "BugReport.xhtml" >
                                #{linkedbugreportslist.bugReport.bugReportId}
                                <f:param name="bugReportId" value="#{linkedbugreportslist.bugReport.bugReportId}" />
                             </h:outputLink>
                        </li>
                    </ui:repeat>
                </ul>
            </p:column>
            <p:column headerText="Similar BR ID"  style="width:60px;">
                <ul class="tablelinks">
                    <ui:repeat value="#{dataItem.similarBugReportIds}" var="similiarbugreports">
                            <li>
                                <h:outputLink class="tablelinks" value = "BugReport.xhtml" >
                                    #{similiarbugreports.similarBugReportId}
                                    <f:param name="bugReportId" value="#{similiarbugreports.similarBugReportId}" />
                                </h:outputLink>
                            </li>
                    </ui:repeat>
                </ul>
            </p:column>
            <p:column headerText="Development Team" sortBy="#{dataItem.developmentTeam}">
                <h:outputText value="#{dataItem.developmentTeam}" />
            </p:column>
            <p:column headerText="Support Severity Estimate" sortBy="#{dataItem.severityEstimate}">
                <h:outputText value="#{dataItem.severityEstimate}" />
            </p:column>
            <p:column headerText="Software Version" sortBy="#{dataItem.softwareVersion}">
                <h:outputText value="#{dataItem.softwareVersion}" />
            </p:column>
            <p:column headerText="User Submitted" sortBy="#{dataItem.userSubmitted}">
                <h:outputText value="#{dataItem.userSubmitted}" />
            </p:column>
            <p:column headerText="Date LBT Opened" sortBy="#{dataItem.dateCreated}">
                <h:outputText value="#{dataItem.dateCreated}" />
            </p:column>
            <p:column headerText="Date 1st Closed" sortBy="#{dataItem.dateAllLinkedBRsClosed}">
                <h:outputText value="#{dataItem.dateAllLinkedBRsClosed}" />
            </p:column>
            <p:column headerText="User Assigned" sortBy="#{dataItem.userAssigned}">
                <h:outputText value="#{dataItem.userAssigned}" />
            </p:column>
            <p:column headerText="Customer Support Team" sortBy="#{dataItem.customerSupportTeam}">
                <h:outputText value="#{dataItem.customerSupportTeam}" />
            </p:column>
        </p:dataTable>
        
    </h:body>
    
</html>
